if [ ! -e /usr/include/cairo/cairo-tee.h ]; then
  message "${PROBLEM_COLOR}Run: ${MODULE_COLOR}lin -rc cairo" &&
  message "${MESSAGE_COLOR}To recompile cairo with tee(libX11) support, which is required by firefox.${DEFAULT_COLOR}" &&
  false
fi &&

default_pre_build &&

# This export is for their hardcoding of autoconf-2.13
export AUTOCONF=autoconf-mozilla &&

cp $SCRIPT_DIRECTORY/mozconfig . &&
export MOZBUILD_STATE_PATH="${SOURCE_DIRECTORY}/build-mozilla" &&
mkdir -p ${MOZBUILD_STATE_PATH} &&

# Google API keys: 
# This api key is for Lunar Linux use ONLY.
# See http://www.chromium.org/developers/how-tos/api-keys
# to get your own set of keys.

cp $SCRIPT_DIRECTORY/google_api_key . &&
echo "ac_add_options --with-google-location-service-api-keyfile=$SOURCE_DIRECTORY/google_api_key" >> mozconfig &&
echo "ac_add_options --with-google-safebrowsing-api-keyfile=$SOURCE_DIRECTORY/google_api_key" >> mozconfig &&

# add optionals from DEPENDS to mozconfig
for flag in $OPTS; do
  echo "ac_add_options $flag" >> mozconfig
done &&

# turn off this #$ bell during build
setterm -bfreq -blength &> /dev/null
